<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Love Notes</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDK -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-auth-compat.js"></script>

</head>
<body>
    <div id="loginScreen" class="login-container">
        <h2>Our Love Notes</h2>
        <p>Enter your shared password to continue</p>
        <input type="password" id="password" placeholder="Enter password">
        <button class="button" onclick="login()">Enter</button>
    </div>

    <div id="appScreen" style="display: none;">
        <div class="header">
            <h1>Our Love Notes</h1>
        </div>
        <div class="container" id="notesContainer">
            <!-- Notes will be added here -->
        </div>
        <button class="new-note" onclick="showModal()">+</button>
    </div>

    <div class="input-modal" id="modal">
        <div class="modal-content">
            <h2>Write a Love Note</h2>
            <input type="text" id="authorInput" placeholder="Your name">
            <textarea id="noteInput" placeholder="Write your message here..."></textarea>
            <div class="button-group">
                <button class="cancel-btn" onclick="hideModal()">Cancel</button>
                <button class="save-btn" onclick="saveNote()">Send</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize Firebase (you'll need to replace this with your own config)
        const firebaseConfig = {
            apiKey: process.env.FIREBASE_API_KEY,
            authDomain: process.env.FIREBASE_AUTH_DOMAIN,
            projectId: process.env.FIREBASE_PROJECT_ID,
            storageBucket: process.env.FIREBASE_STORAGE_BUCKET,
            messagingSenderId: process.env.FIREBASE_MESSAGING_SENDER_ID,
            appId: process.env.FIREBASE_APP_ID
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        // Authentication
        function login() {
            const password = document.getElementById('password').value;
            // You'll set this password when setting up Firebase
            if (password === 'SophandChrisBaba1!') {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('appScreen').style.display = 'block';
                loadNotes();
            } else {
                alert('Incorrect password');
            }
        }

        // Load notes from Firebase
        function loadNotes() {
            db.collection('notes')
                .orderBy('date', 'desc')
                .onSnapshot((snapshot) => {
                    const container = document.getElementById('notesContainer');
                    container.innerHTML = '';
                    
                    snapshot.forEach((doc) => {
                        const note = doc.data();
                        const noteElement = document.createElement('div');
                        noteElement.className = 'love-note';
                        noteElement.innerHTML = `
                            <div class="author">${note.author}</div>
                            <div class="date">${new Date(note.date).toLocaleString()}</div>
                            <p class="message">${note.message}</p>
                        `;
                        container.appendChild(noteElement);
                    });
                });
        }

        function showModal() {
            document.getElementById('modal').style.display = 'block';
        }

        function hideModal() {
            document.getElementById('modal').style.display = 'none';
            document.getElementById('noteInput').value = '';
            document.getElementById('authorInput').value = '';
        }

        function saveNote() {
            const message = document.getElementById('noteInput').value.trim();
            const author = document.getElementById('authorInput').value.trim() || 'Anonymous';
            
            if (message) {
                db.collection('notes').add({
                    author: author,
                    message: message,
                    date: new Date().toISOString()
                });
                hideModal();
            }
        }
    </script>
</body>
</html>